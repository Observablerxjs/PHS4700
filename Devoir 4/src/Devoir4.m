function [xi,yi,zi,face] = Devoir4(nout,nin,depart)    xi = [0];  yi = [0];  zi = [0];  face = [0];    pos_ellipsoid = [4,4,11];   rad = 3;  bval = 9;    [polMax polMin azimMax azimMin] = TrouverAngles(depart);    iter_pol = 50;  iter_azim = 50;    pos = depart;    n1 = nout;  n2 = nin;    for dp = 1:iter_pol    for da = 1:iter_azim            pol_n = polMin + ((polMax - polMin)/(2*iter_pol)) * ((2*dp)-1);      azim_m = azimMin + ((azimMax - azimMin)/(2*iter_azim)) * ((2*da)-1);            nb_refraction_interne = 0;            rayon_dehors = 1;            rayon_vec = [sin(pol_n) * cos(azim_m), sin(pol_n) * sin(azim_m), cos(pol_n)];            # premiere verification: Le rayon provenant de lâ€™exterieur ne croise pas le bloc cylindrique transparent. Dans ce cas, le rayon est rejete.      [point_intersection] = intersectionEllipsoidLigne(pos,rayon_vec,pos_ellipsoid, rayon_dehors);            if (point_intersection != NaN)                        # Determiner si rayon n'est pas reflechi                angle_critique = asin(n2/n1);                normale = [(point_intersection(1)-4)/rad^2 (point_intersection(2)-4)/rad^2 (point_intersection(3)-11)/bval^2];                angle_incident = acos(dot(normale,rayon_vec)/norm(normale)*norm(rayon_vec));                if n1 > n2 && angle_incident > angle_critique                rayon_dehors = 0;                while nb_refraction_interne <= 100 and !rayon_dehors                        endwhile                      endif                 endfor  endfor  
endfunction
