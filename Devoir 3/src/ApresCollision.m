function [vitBloc wBloc vitBalle] = ApresCollision(normale,p_intersec,posBalle,vitBalle,posBloc,vitBloc,wBloc)  restitution = 0.8;    mBloc = 0.58;  coteBloc = 0.06;    mBalle = 0.07;  rBalle = 0.02;  wBalle = [0,0,0];    rBlocp = p_intersec - posBloc;  rBallep = p_intersec - posBalle;    IBloc = [            (mBloc*coteBloc^2)/6,0,0;            0,(mBloc*coteBloc^2)/6,0;            0,0,(mBloc*coteBloc^2)/6            ];              IBalle = [          (2*mBalle*rBalle^2)/5,0,0;          0,(2*mBalle*rBalle^2)/5,0;          0,0,(2*mBalle*rBalle^2)/5          ];            vBlocp = vitBloc' + (cross(wBloc, rBlocp));    vr_ = dot(normale,(vBlocp-vitBalle'));    invIbloc = inv(IBloc);  invIballe = inv(IBalle);    first_term_bloc = invIbloc*cross(rBlocp',normale');  first_term_balle = invIballe*cross(rBallep',normale');    GBloc = dot(normale,(cross(first_term_bloc,rBlocp')));  GBalle = dot(normale,(cross(first_term_balle,rBallep')));    alpha = 1/((1/mBalle)+(1/mBloc)+GBloc+GBalle);    j = - alpha*(1+restitution)*vr_;    J = normale * j;    vitBloc = vitBloc + (J/mBloc)';  vitBalle = vitBalle - (J/mBalle)';    wBloc = wBloc + (inv(IBloc)*(cross(rBlocp',J')))';  
endfunction
